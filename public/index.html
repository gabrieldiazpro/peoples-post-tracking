<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Routz - Logistics Platform</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/recharts@2.10.3/umd/Recharts.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#00FF88">
    <style>
        * { font-family: 'Inter', sans-serif; }
        .fade-in { animation: fadeIn 0.3s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect } = React;
        const { AreaChart, Area, LineChart, Line, PieChart, Pie, Cell, XAxis, YAxis, Tooltip, ResponsiveContainer, CartesianGrid } = Recharts;

        // Components
        const StatCard = ({ icon, label, value, change, changeType, color = 'default', onClick }) => {
            const colors = {
                default: 'bg-white',
                green: 'bg-gradient-to-br from-green-50 to-emerald-50 border-green-100',
                blue: 'bg-gradient-to-br from-blue-50 to-indigo-50 border-blue-100',
                yellow: 'bg-gradient-to-br from-yellow-50 to-amber-50 border-yellow-100',
            };
            return (
                <div className={`${colors[color]} border border-gray-100 rounded-2xl p-5 hover:shadow-lg transition-all cursor-pointer fade-in`} onClick={onClick}>
                    <div className="flex items-start justify-between">
                        <div>
                            <p className="text-sm text-gray-500 mb-1">{label}</p>
                            <p className="text-3xl font-bold text-gray-900">{value}</p>
                            {change && <p className={`text-sm mt-2 ${changeType === 'up' ? 'text-green-600' : changeType === 'down' ? 'text-red-600' : 'text-gray-500'}`}>{changeType === 'up' ? '‚Üë' : '‚Üì'} {change}</p>}
                        </div>
                        <div className="w-12 h-12 bg-white rounded-xl flex items-center justify-center text-2xl shadow-sm">{icon}</div>
                    </div>
                </div>
            );
        };

        const StatusBadge = ({ status }) => {
            const configs = {
                pending: { bg: 'bg-yellow-100', text: 'text-yellow-700', dot: 'bg-yellow-500', label: 'En attente' },
                in_transit: { bg: 'bg-blue-100', text: 'text-blue-700', dot: 'bg-blue-500', label: 'En transit' },
                delivered: { bg: 'bg-green-100', text: 'text-green-700', dot: 'bg-green-500', label: 'Livr√©' },
                exception: { bg: 'bg-red-100', text: 'text-red-700', dot: 'bg-red-500', label: 'Exception' },
            };
            const config = configs[status] || configs.pending;
            return <span className={`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium ${config.bg} ${config.text}`}><span className={`w-1.5 h-1.5 rounded-full ${config.dot}`}></span>{config.label}</span>;
        };

        const CarrierLogo = ({ carrier }) => {
            const logos = { colissimo: 'üìÆ', chronopost: '‚ö°', mondial_relay: 'üè™', dhl: 'üì¶', ups: 'üü§' };
            return <div className="w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center">{logos[carrier] || 'üì¶'}</div>;
        };

        const QuickAction = ({ icon, label, description, href, badge }) => (
            <a href={href} className="block p-4 bg-white border border-gray-100 rounded-xl hover:shadow-md hover:border-[#00FF88] transition-all group">
                <div className="flex items-start gap-3">
                    <div className="w-10 h-10 bg-gray-100 group-hover:bg-[#00FF88]/20 rounded-xl flex items-center justify-center text-xl">{icon}</div>
                    <div className="flex-1">
                        <div className="flex items-center gap-2">
                            <p className="font-medium text-gray-900">{label}</p>
                            {badge && <span className="px-2 py-0.5 bg-red-100 text-red-700 rounded-full text-xs">{badge}</span>}
                        </div>
                        <p className="text-sm text-gray-500">{description}</p>
                    </div>
                </div>
            </a>
        );

        const AlertBanner = ({ type, message, onDismiss }) => (
            <div className={`${type === 'warning' ? 'bg-yellow-50 border-yellow-200 text-yellow-800' : 'bg-red-50 border-red-200 text-red-800'} border rounded-xl p-4 flex items-center justify-between fade-in`}>
                <div className="flex items-center gap-3"><span className="text-xl">{type === 'warning' ? '‚ö†Ô∏è' : 'üö®'}</span><p>{message}</p></div>
                {onDismiss && <button onClick={onDismiss} className="text-gray-400 hover:text-gray-600">‚úï</button>}
            </div>
        );

        // Main Dashboard
        const MainDashboard = () => {
            const [sidebarCollapsed, setSidebarCollapsed] = useState(false);
            const [dateRange, setDateRange] = useState('7d');
            const [notifications] = useState(3);
            const [alerts, setAlerts] = useState([{ id: 1, type: 'warning', message: '5 exp√©ditions en exception n√©cessitent votre attention' }]);

            const stats = { shipmentsToday: 127, shipmentsChange: '+12%', pendingOrders: 23, deliveryRate: 94.5, deliveryChange: '+2.1%', activeReturns: 8, revenue: 4823 };

            const activityData = [
                { day: 'Lun', shipments: 45, delivered: 42 }, { day: 'Mar', shipments: 52, delivered: 48 },
                { day: 'Mer', shipments: 38, delivered: 35 }, { day: 'Jeu', shipments: 65, delivered: 61 },
                { day: 'Ven', shipments: 78, delivered: 74 }, { day: 'Sam', shipments: 42, delivered: 40 },
                { day: 'Dim', shipments: 15, delivered: 14 },
            ];

            const carrierData = [
                { name: 'Colissimo', value: 35, color: '#FBBF24' }, { name: 'Chronopost', value: 28, color: '#3B82F6' },
                { name: 'Mondial Relay', value: 20, color: '#F97316' }, { name: 'DHL', value: 10, color: '#EAB308' },
                { name: 'Autres', value: 7, color: '#9CA3AF' },
            ];

            const recentShipments = [
                { id: 'SHP-001', tracking: '6L123456789FR', carrier: 'colissimo', status: 'in_transit', customer: 'Marie Dupont', destination: 'Lyon', date: '10:30' },
                { id: 'SHP-002', tracking: 'XY987654321FR', carrier: 'chronopost', status: 'delivered', customer: 'Jean Martin', destination: 'Paris', date: '09:45' },
                { id: 'SHP-003', tracking: 'MR456789123', carrier: 'mondial_relay', status: 'pending', customer: 'Sophie Bernard', destination: 'Marseille', date: '09:15' },
                { id: 'SHP-004', tracking: 'JJD123456789', carrier: 'dhl', status: 'in_transit', customer: 'Pierre Durand', destination: 'Bordeaux', date: '08:50' },
                { id: 'SHP-005', tracking: '6L987654321FR', carrier: 'colissimo', status: 'exception', customer: 'Emma Rousseau', destination: 'Toulouse', date: '08:20' },
            ];

            const pendingOrders = [
                { id: 'ORD-234', customer: 'Lucas Petit', items: 3, total: 89.90, source: 'shopify', created: '11:00' },
                { id: 'ORD-235', customer: 'Camille Leroy', items: 1, total: 45.00, source: 'woocommerce', created: '10:45' },
                { id: 'ORD-236', customer: 'Hugo Moreau', items: 2, total: 129.90, source: 'amazon', created: '10:30' },
            ];

            const deliveryPerformance = [
                { carrier: 'Chronopost', onTime: 98 }, { carrier: 'Colissimo', onTime: 94 },
                { carrier: 'DHL', onTime: 96 }, { carrier: 'Mondial Relay', onTime: 91 },
            ];

            const navItems = [
                { icon: 'üìä', label: 'Dashboard', href: '/', active: true },
                { icon: 'üì¶', label: 'Exp√©ditions', href: '/shipments.html', badge: stats.shipmentsToday },
                { icon: 'üõí', label: 'Commandes', href: '/orders.html', badge: stats.pendingOrders },
                { icon: 'üîÑ', label: 'Retours', href: '/returns.html', badge: stats.activeReturns },
                { icon: 'üìà', label: 'QoS', href: '/qos.html' },
                { icon: 'üí¨', label: 'Support', href: '/support.html' },
                { icon: 'üåç', label: 'International', href: '/international.html' },
                { icon: 'üì¶', label: 'Inventaire', href: '/inventory.html' },
                { icon: 'üè≠', label: 'Entrep√¥ts', href: '/warehouses.html' },
                { icon: 'ü§ñ', label: 'S√©lection IA', href: '/carrier-selection.html' },
                { icon: '‚ö°', label: 'Live', href: '/dashboard-live.html' },
                { icon: 'üìÑ', label: 'Rapports', href: '/reports.html' },
                { icon: '‚öôÔ∏è', label: 'Param√®tres', href: '/settings.html' },
                { icon: 'üîó', label: 'API', href: '/docs/' },
            ];

            return (
                <div className="min-h-screen bg-gray-50 flex">
                    {/* Sidebar */}
                    <aside className={`bg-white border-r border-gray-200 flex flex-col transition-all sticky top-0 h-screen ${sidebarCollapsed ? 'w-20' : 'w-64'}`}>
                        <div className="p-4 border-b border-gray-100">
                            <div className="flex items-center gap-3">
                                <div className="w-10 h-10 bg-gradient-to-br from-[#00FF88] to-[#00D4AA] rounded-xl flex items-center justify-center shadow-lg shadow-[#00FF88]/20">
                                    <span className="text-black font-bold text-lg">R</span>
                                </div>
                                {!sidebarCollapsed && <span className="font-bold text-gray-900 text-lg">Routz</span>}
                            </div>
                        </div>
                        <nav className="flex-1 p-3 space-y-1 overflow-y-auto">
                            {navItems.map((item, i) => (
                                <a key={i} href={item.href} className={`flex items-center gap-3 px-3 py-2.5 rounded-xl transition-all ${item.active ? 'bg-[#00FF88] text-black font-medium shadow-lg shadow-[#00FF88]/20' : 'text-gray-600 hover:bg-gray-100'}`}>
                                    <span className="text-lg">{item.icon}</span>
                                    {!sidebarCollapsed && <div className="flex-1 flex items-center justify-between"><span>{item.label}</span>{item.badge && <span className="px-2 py-0.5 bg-white/50 rounded-full text-xs font-medium">{item.badge}</span>}</div>}
                                </a>
                            ))}
                        </nav>
                        <div className="p-3 border-t border-gray-100">
                            <button onClick={() => setSidebarCollapsed(!sidebarCollapsed)} className="w-full flex items-center justify-center gap-2 px-3 py-2 text-gray-500 hover:bg-gray-100 rounded-xl">{sidebarCollapsed ? '‚Üí' : '‚Üê R√©duire'}</button>
                        </div>
                    </aside>

                    {/* Main */}
                    <div className="flex-1 flex flex-col min-h-screen">
                        {/* Header */}
                        <header className="bg-white border-b border-gray-200 px-6 py-4 sticky top-0 z-10">
                            <div className="flex items-center justify-between">
                                <div><h1 className="text-2xl font-bold text-gray-900">Dashboard</h1><p className="text-sm text-gray-500">Bienvenue, Gabriel üëã</p></div>
                                <div className="flex items-center gap-4">
                                    <select value={dateRange} onChange={e => setDateRange(e.target.value)} className="px-4 py-2 border border-gray-200 rounded-xl bg-white">
                                        <option value="today">Aujourd'hui</option><option value="7d">7 jours</option><option value="30d">30 jours</option>
                                    </select>
                                    <button className="relative p-2 hover:bg-gray-100 rounded-xl"><span className="text-xl">üîî</span>{notifications > 0 && <span className="absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center">{notifications}</span>}</button>
                                    <a href="/admin.html" className="px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-xl text-sm font-medium">Admin</a>
                                    <div className="w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold">G</div>
                                </div>
                            </div>
                        </header>

                        <main className="flex-1 p-6 space-y-6">
                            {/* Alerts */}
                            {alerts.map(alert => <AlertBanner key={alert.id} type={alert.type} message={alert.message} onDismiss={() => setAlerts(prev => prev.filter(a => a.id !== alert.id))} />)}

                            {/* Stats */}
                            <div className="grid grid-cols-5 gap-4">
                                <StatCard icon="üì¶" label="Exp√©ditions aujourd'hui" value={stats.shipmentsToday} change={stats.shipmentsChange} changeType="up" color="blue" onClick={() => window.location.href='/shipments.html'} />
                                <StatCard icon="üõí" label="Commandes en attente" value={stats.pendingOrders} change="√† traiter" color="yellow" onClick={() => window.location.href='/orders.html'} />
                                <StatCard icon="‚úÖ" label="Taux de livraison" value={`${stats.deliveryRate}%`} change={stats.deliveryChange} changeType="up" color="green" onClick={() => window.location.href='/qos.html'} />
                                <StatCard icon="üîÑ" label="Retours en cours" value={stats.activeReturns} onClick={() => window.location.href='/returns.html'} />
                                <StatCard icon="üí∞" label="CA du jour" value={`${stats.revenue}‚Ç¨`} change="+18%" changeType="up" color="green" />
                            </div>

                            {/* Charts */}
                            <div className="grid grid-cols-3 gap-6">
                                <div className="col-span-2 bg-white rounded-2xl border border-gray-100 p-6">
                                    <div className="flex items-center justify-between mb-6">
                                        <h2 className="text-lg font-semibold text-gray-900">Activit√© de la semaine</h2>
                                        <div className="flex gap-4 text-sm"><span className="flex items-center gap-2"><span className="w-3 h-3 bg-[#00FF88] rounded-full"></span> Exp√©ditions</span><span className="flex items-center gap-2"><span className="w-3 h-3 bg-blue-500 rounded-full"></span> Livr√©es</span></div>
                                    </div>
                                    <ResponsiveContainer width="100%" height={280}>
                                        <AreaChart data={activityData}>
                                            <defs>
                                                <linearGradient id="colorShipments" x1="0" y1="0" x2="0" y2="1"><stop offset="5%" stopColor="#00FF88" stopOpacity={0.3}/><stop offset="95%" stopColor="#00FF88" stopOpacity={0}/></linearGradient>
                                                <linearGradient id="colorDelivered" x1="0" y1="0" x2="0" y2="1"><stop offset="5%" stopColor="#3B82F6" stopOpacity={0.3}/><stop offset="95%" stopColor="#3B82F6" stopOpacity={0}/></linearGradient>
                                            </defs>
                                            <CartesianGrid strokeDasharray="3 3" stroke="#f0f0f0" />
                                            <XAxis dataKey="day" axisLine={false} tickLine={false} />
                                            <YAxis axisLine={false} tickLine={false} />
                                            <Tooltip contentStyle={{ borderRadius: '12px', border: 'none', boxShadow: '0 4px 20px rgba(0,0,0,0.1)' }} />
                                            <Area type="monotone" dataKey="shipments" stroke="#00FF88" strokeWidth={2} fill="url(#colorShipments)" />
                                            <Area type="monotone" dataKey="delivered" stroke="#3B82F6" strokeWidth={2} fill="url(#colorDelivered)" />
                                        </AreaChart>
                                    </ResponsiveContainer>
                                </div>
                                <div className="bg-white rounded-2xl border border-gray-100 p-6">
                                    <h2 className="text-lg font-semibold text-gray-900 mb-6">R√©partition transporteurs</h2>
                                    <ResponsiveContainer width="100%" height={200}>
                                        <PieChart><Pie data={carrierData} innerRadius={60} outerRadius={80} paddingAngle={5} dataKey="value">{carrierData.map((entry, index) => <Cell key={`cell-${index}`} fill={entry.color} />)}</Pie><Tooltip /></PieChart>
                                    </ResponsiveContainer>
                                    <div className="space-y-2 mt-4">{carrierData.map((item, i) => <div key={i} className="flex items-center justify-between text-sm"><div className="flex items-center gap-2"><span className="w-3 h-3 rounded-full" style={{ backgroundColor: item.color }}></span><span className="text-gray-600">{item.name}</span></div><span className="font-medium">{item.value}%</span></div>)}</div>
                                </div>
                            </div>

                            {/* Quick Actions & Recent */}
                            <div className="grid grid-cols-3 gap-6">
                                <div className="space-y-4">
                                    <h2 className="text-lg font-semibold text-gray-900">Actions rapides</h2>
                                    <QuickAction icon="üì¶" label="Nouvelle exp√©dition" description="Cr√©er une exp√©dition" href="/shipments.html" />
                                    <QuickAction icon="ü§ñ" label="S√©lection IA" description="Recommandation transporteur" href="/carrier-selection.html" />
                                    <QuickAction icon="üîÑ" label="G√©rer les retours" description="Traiter les demandes" href="/returns.html" badge={stats.activeReturns} />
                                    <QuickAction icon="üìö" label="Documentation API" description="Int√©grez Routz" href="/docs/" />
                                </div>
                                <div className="col-span-2 bg-white rounded-2xl border border-gray-100 p-6">
                                    <div className="flex items-center justify-between mb-4"><h2 className="text-lg font-semibold text-gray-900">Derni√®res exp√©ditions</h2><a href="/shipments.html" className="text-sm text-[#00D4AA] hover:underline">Voir tout ‚Üí</a></div>
                                    <table className="w-full">
                                        <thead><tr className="text-left text-xs text-gray-500 uppercase"><th className="pb-3">Tracking</th><th className="pb-3">Transporteur</th><th className="pb-3">Client</th><th className="pb-3">Destination</th><th className="pb-3">Statut</th><th className="pb-3">Heure</th></tr></thead>
                                        <tbody className="divide-y divide-gray-100">
                                            {recentShipments.map(s => (
                                                <tr key={s.id} className="hover:bg-gray-50 cursor-pointer" onClick={() => window.location.href = '/shipments.html'}>
                                                    <td className="py-3"><span className="font-mono text-sm text-blue-600">{s.tracking}</span></td>
                                                    <td className="py-3"><div className="flex items-center gap-2"><CarrierLogo carrier={s.carrier} /><span className="text-sm text-gray-600 capitalize">{s.carrier}</span></div></td>
                                                    <td className="py-3 text-gray-900">{s.customer}</td>
                                                    <td className="py-3 text-gray-600">{s.destination}</td>
                                                    <td className="py-3"><StatusBadge status={s.status} /></td>
                                                    <td className="py-3 text-gray-500 text-sm">{s.date}</td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            {/* Performance & Orders */}
                            <div className="grid grid-cols-2 gap-6">
                                <div className="bg-white rounded-2xl border border-gray-100 p-6">
                                    <h2 className="text-lg font-semibold text-gray-900 mb-4">Performance livraison</h2>
                                    <div className="space-y-4">
                                        {deliveryPerformance.map((item, i) => (
                                            <div key={i}>
                                                <div className="flex items-center justify-between text-sm mb-1"><span className="text-gray-700">{item.carrier}</span><span className="font-medium text-green-600">{item.onTime}% √† l'heure</span></div>
                                                <div className="h-2 bg-gray-100 rounded-full overflow-hidden"><div className="h-full bg-gradient-to-r from-[#00FF88] to-[#00D4AA] rounded-full" style={{ width: `${item.onTime}%` }}></div></div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                                <div className="bg-white rounded-2xl border border-gray-100 p-6">
                                    <div className="flex items-center justify-between mb-4"><h2 className="text-lg font-semibold text-gray-900">Commandes √† traiter</h2><a href="/orders.html" className="text-sm text-[#00D4AA] hover:underline">Voir tout ‚Üí</a></div>
                                    <div className="space-y-3">
                                        {pendingOrders.map(order => (
                                            <div key={order.id} className="flex items-center justify-between p-3 bg-gray-50 rounded-xl hover:bg-gray-100 cursor-pointer" onClick={() => window.location.href = '/orders.html'}>
                                                <div className="flex items-center gap-3">
                                                    <span className={`w-8 h-8 rounded-lg flex items-center justify-center ${order.source === 'shopify' ? 'bg-green-100' : order.source === 'amazon' ? 'bg-yellow-100' : 'bg-purple-100'}`}>{order.source === 'shopify' ? 'üõí' : order.source === 'amazon' ? 'üì¶' : 'üîÆ'}</span>
                                                    <div><p className="font-medium text-gray-900">{order.customer}</p><p className="text-sm text-gray-500">{order.id} ‚Ä¢ {order.items} article{order.items > 1 ? 's' : ''}</p></div>
                                                </div>
                                                <div className="text-right"><p className="font-bold text-gray-900">{order.total.toFixed(2)}‚Ç¨</p><p className="text-xs text-gray-500">{order.created}</p></div>
                                            </div>
                                        ))}
                                    </div>
                                    <button className="w-full mt-4 py-2 bg-[#00FF88] text-black font-medium rounded-xl hover:bg-[#00E07A] transition-colors">üì¶ Exp√©dier toutes les commandes</button>
                                </div>
                            </div>
                        </main>
                    </div>
                </div>
            );
        };

        ReactDOM.createRoot(document.getElementById('root')).render(<MainDashboard />);
    </script>
</body>
</html>
